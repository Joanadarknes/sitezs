<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Zona Sul Ag√™ncia Criativa</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700;800;900&display=swap" rel="stylesheet">

  <style>
    :root{
      --cursor-default: url("cursor-white.png") 12 2, auto;
      --cursor-pointer: url("cursor-white.png") 12 2, pointer;

      --bg:#07090d;
      --text:#ffffff;
      --muted:rgba(255,255,255,0.72);

      --accent:#00c8ff;

      --border: rgba(255,255,255,0.10);
      --radius:18px;
      --ease: cubic-bezier(.2,.9,.3,1);

      --topspace: 120px;
      --container: 1120px;
    }

    [data-theme="light"]{
      --cursor-default: url("cursor-white.png") 12 2, auto;
      --cursor-pointer: url("cursor-white.png") 12 2, pointer;

      --bg:#ffffff;
      --text:#0b1020;
      --muted:rgba(11,16,32,0.68);

      --border: rgba(0,0,0,0.12);
      --accent:#00c8ff;
    }

    *{ box-sizing:border-box }
    html{ scroll-behavior:smooth }
    body{
      margin:0;
      background:var(--bg);
      color:var(--text);
      font-family:'Poppins',sans-serif;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      line-height:1.6;
      overflow-x:hidden;
    }

    a{ color:inherit; text-decoration:none }
    img{ display:block; max-width:100% }
    button{ font-family:inherit }
    .brand{ color:var(--accent); font-weight:700; }

    /* =========================================================
       TEXTURA GRANULADO
       ========================================================= */
    .grain-layer{
      position: fixed;
      inset: 0;
      z-index: 4;
      pointer-events: none;

      opacity: .20;
      mix-blend-mode: soft-light;
      filter: contrast(150%) brightness(115%);
    }

    .grain-layer::before{
      content:"";
      position:absolute;
      inset:-25%;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='260' height='260'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='260' height='260' filter='url(%23n)' opacity='0.95'/%3E%3C/svg%3E");
      background-repeat: repeat;
      transform: translateZ(0) scale(1.15);
    }

    [data-theme="light"] .grain-layer{
      opacity: .14;
      mix-blend-mode: multiply;
      filter: contrast(125%) brightness(105%);
    }

    /* ===== Aviso acima do bot√£o (igual print) ===== */
    .info-note{
      width: 100%;
      border-radius: 16px;
      padding: .9rem 1rem;
      display:flex;
      align-items:center;
      gap:.75rem;

      background: linear-gradient(180deg, rgba(0,200,255,0.10), rgba(0,200,255,0.05));
      border: 1px solid rgba(0,200,255,0.18);

      backdrop-filter: blur(14px);
      box-shadow: 0 14px 55px rgba(0,0,0,0.18);
      margin-top: .2rem;
    }

  .info-ic{
    width: 26px;
    height: 26px;
    border-radius: 999px;
    display:grid;
    place-items:center;

    background: rgba(0,200,255,0.12);
    border: 1px solid rgba(0,200,255,0.20);
    color: var(--text);
    font-weight: 900;
    font-size: .92rem;
    line-height: 1;
    flex:0 0 26px;
  }

  .info-text{
    color: var(--muted);
    font-weight: 500;
    font-size: .92rem;
  }

  /* tema claro */
  [data-theme="light"] .info-note{
    background: linear-gradient(180deg, rgba(0,200,255,0.10), rgba(0,200,255,0.06));
    border: 1px solid rgba(0,0,0,0.10);
    box-shadow: 0 14px 45px rgba(0,0,0,0.08);
  }
  [data-theme="light"] .info-text{
    color: rgba(11,16,32,0.70);
  }

    /* =========================================================
   FUNDO: 1 LOGO GRANDE GIRANDO (central)
   ========================================================= */

  .bg-logo{
    position: fixed;
    inset: 0;
    z-index: 0;
    pointer-events: none;
    overflow: hidden;
  }

  .bg-logo::before{
    content:"";
    position:absolute;
    left:50%;
    top:52%;

    width:min(1600px, 120vmax);
    height:min(1600px, 120vmax);

    transform: translate(-50%,-50%) rotate(0deg);

    background-image: url('logo-bg.png');
    background-repeat: no-repeat;
    background-position: center;
    background-size: contain;

    opacity: 0.10;
    filter: blur(2.2px) saturate(1.12);
    mix-blend-mode: screen;

    animation: logoSpin 48s linear infinite;

    will-change: transform;
  }

  @keyframes logoSpin{
    from { transform: translate(-50%,-50%) rotate(0deg); }
    to   { transform: translate(-50%,-50%) rotate(360deg); }
  }

    /* ‚úÖ LUZ PASSANDO (1 s√≥, suave) */
    .bg-beam{
      position: fixed;
      inset: 0;
      z-index: 2;
      pointer-events: none;
      mix-blend-mode: screen;
      opacity: 1;
      will-change: transform, opacity;
    }
    .bg-beam::before{
      content:"";
      position:absolute;
      left: -20%;
      top: -25%;
      width: min(980px, 78vmax);
      height: min(980px, 78vmax);
      border-radius: 999px;
      background: radial-gradient(circle at 35% 35%,
        rgba(0,200,255,0.34) 0%,
        rgba(0,200,255,0.20) 22%,
        rgba(0,200,255,0.10) 42%,
        rgba(0,200,255,0.00) 72%
      );
      filter: blur(58px);
      transform: translate3d(0,0,0);
      opacity: .95;
      animation: beamWander 18s cubic-bezier(.2,.9,.3,1) infinite;
    }
    @keyframes beamWander{
      0%   { transform: translate3d(0,0,0) scale(1);    opacity:.55; }
      22%  { transform: translate3d(38vw, 10vh,0) scale(1.06); opacity:.72; }
      55%  { transform: translate3d(62vw, 36vh,0) scale(1.03); opacity:.60; }
      78%  { transform: translate3d(18vw, 58vh,0) scale(1.08); opacity:.70; }
      100% { transform: translate3d(0,0,0) scale(1);    opacity:.55; }
    }
    [data-theme="light"] .bg-beam{ mix-blend-mode: multiply; }
    [data-theme="light"] .bg-beam::before{ opacity:.55; filter: blur(52px); }

    /* ===== Canvas do rastro do mouse ===== */
    #sparkleCanvas{
      position: fixed;
      inset: 0;
      z-index: 2600;
      pointer-events: none;
      width: 100%;
      height: 100%;

      /* o ‚Äúlook‚Äù de luz na tela */
      mix-blend-mode: screen;
      opacity: .95;
    }

    /* ===== Preloader ===== */
    #preloader{
      position:fixed; inset:0;
      display:flex; align-items:center; justify-content:center;
      background:var(--bg);
      z-index:3000;
      transition:opacity .45s var(--ease);
    }
    #preloader.loaded{ opacity:0; pointer-events:none }
    .spinner{
      width:64px;height:64px;border-radius:50%;
      border:6px solid rgba(255,255,255,0.08);
      border-top-color:var(--accent);
      animation:spin 1.1s linear infinite
    }
    [data-theme="light"] .spinner{ border:6px solid rgba(0,0,0,0.08); border-top-color:var(--accent); }
    @keyframes spin{ to{ transform:rotate(360deg); } }

    /* ===== Layout ===== */
    .container{
      width:92%;
      max-width:var(--container);
      margin:0 auto;
      padding:0 0 3rem;
      position:relative;
      z-index:5;
    }

    .top-space{
      height: var(--topspace);
      display:flex;
      align-items:center;
      justify-content:center;
      text-align:center;
      position:relative;
      z-index:5;
    }
    .logo-wrap img{
      max-height:260px;
      width:auto;
      margin-top: 85px;
      filter: drop-shadow(0 0 22px rgba(0,200,255,0.20));
    }

    .floating-controls{
      position:fixed;
      top:18px;
      right:18px;
      z-index:2500;
      display:flex;
      gap:.6rem;
      align-items:center;
    }
    .icon-btn{
      background: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02));
      border:1px solid var(--border);
      color:var(--muted);
      font-size:1.05rem;
      padding:.65rem .75rem;
      border-radius:14px;
      transition: transform .22s var(--ease);
      backdrop-filter: blur(12px);
      box-shadow: 0 12px 40px rgba(0,0,0,0.18);
    }
    .icon-btn:hover{ transform:translateY(-3px); }

    /* =========================================================
       ‚úÖ SETINHA FIXA (canto inferior direito)
       ========================================================= */
    .scroll-fab{
      position: fixed;
      right: 18px;
      bottom: 18px;
      z-index: 2500;
      width: 54px;
      height: 54px;
      border-radius: 16px;
      border: 1px solid var(--border);
      background: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02));
      color: var(--text);
      display: grid;
      place-items: center;
      cursor: pointer;
      backdrop-filter: blur(12px);
      box-shadow: 0 16px 55px rgba(0,0,0,0.22);
      transition: transform .22s var(--ease), box-shadow .22s var(--ease);
      -webkit-tap-highlight-color: transparent;
    }
    .scroll-fab:hover{
      transform: translateY(-4px);
      box-shadow: 0 22px 80px rgba(0,0,0,0.28);
    }
    .scroll-fab:active{ transform: translateY(-2px) scale(0.99); }
    .scroll-fab span{
      font-size: 1.25rem;
      font-weight: 900;
      line-height: 1;
      transform: translateY(-1px);
      text-shadow: 0 0 16px rgba(0,200,255,0.15);
    }
    [data-theme="light"] .scroll-fab{
      background: linear-gradient(180deg, rgba(0,0,0,0.05), rgba(0,0,0,0.02));
      box-shadow: 0 14px 45px rgba(0,0,0,0.10);
    }

    section.content{ padding: 4.2rem 0; }

    #sobre .profile{
      display:flex;
      flex-direction:column;
      align-items:center;
      text-align:center;
      gap: 1.25rem;
      margin-top: 1.6rem;
    }

    .profile-left{
      width:auto;
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:1rem;
    }

    .avatar{
      width:190px; height:190px; object-fit:cover;
      border-radius:999px;
      border:4px solid rgba(0,200,255,0.85);
      box-shadow: 0 16px 70px rgba(0,200,255,0.10);
      background: rgba(255,255,255,0.04);
    }

    .mini-icons{
      display:flex;
      gap:.65rem;
      align-items:center;
      justify-content:center;
      background: linear-gradient(180deg, rgba(255,255,255,0.05), rgba(255,255,255,0.02));
      border:1px solid var(--border);
      padding:.6rem .75rem;
      border-radius:16px;
      backdrop-filter: blur(12px);
    }
    .mini-icons a{
      width:42px; height:42px;
      display:grid; place-items:center;
      border-radius:14px;
      border:1px solid rgba(255,255,255,0.10);
      background: rgba(0,0,0,0.28);
      transition: transform .22s var(--ease), border-color .22s var(--ease), background .22s var(--ease);
    }
    [data-theme="light"] .mini-icons a{
      background: rgba(0,0,0,0.05);
      border:1px solid rgba(0,0,0,0.12);
    }
    .mini-icons a:hover{
      transform: translateY(-4px);
      border-color: rgba(0,200,255,0.35);
      background: rgba(0,200,255,0.08);
    }
    .mini-icons img{ width:22px; height:22px; object-fit:contain }

    .profile-right{
      width:100%;
      max-width: 760px;
      display:flex;
      flex-direction:column;
      align-items:center;
      gap: 0.9rem;
    }

    .name{
      margin:0 0 .25rem;
      color: var(--accent);
      font-weight:900;
      font-size: clamp(1.25rem, 2.2vw, 1.7rem);
      letter-spacing:.2px;
    }
    .bio{
      margin:0;
      color: var(--muted);
      font-weight: 300;
      max-width: 70ch;
    }

    /* ===== Card estilo ‚ÄúDiscord Join‚Äù ===== */
    .cta{
      margin: .6rem auto 0;
      display:flex;
      justify-content:center;
      width:100%;
      max-width: 700px;
      flex-direction: column;
      align-items: center;
      gap: 4.8rem;
    }

    .discord-card{
      width: 75%;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 1rem;
      padding: .95rem 1.05rem;
      border-radius: 18px;
      border: 1px solid rgba(255,255,255,0.10);
      background: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02));
      backdrop-filter: blur(14px);
      box-shadow: 0 18px 70px rgba(0,0,0,0.25);
      overflow:hidden;
      position:relative;
    }
    [data-theme="light"] .discord-card{
      border: 1px solid rgba(0,0,0,0.10);
      background: linear-gradient(180deg, rgba(0,0,0,0.04), rgba(0,0,0,0.02));
      box-shadow: 0 14px 50px rgba(0,0,0,0.10);
    }
    .discord-card::before{
      content:"";
      position:absolute; inset:-2px;
      background: radial-gradient(650px 220px at 15% 0%, rgba(0,200,255,0.22), transparent 55%);
      opacity:.35;
      pointer-events:none;
    }

    .dc-left{
      display:flex;
      align-items:center;
      gap:.85rem;
      min-width: 0;
      position:relative;
      z-index:1;
    }

    .dc-logo-slot{
      width: 42px;
      height: 42px;
      border-radius: 14px;
      display:grid;
      place-items:center;
      background: rgba(0,0,0,0.30);
      border:1px solid rgba(255,255,255,0.10);
      overflow:hidden;
      flex:0 0 42px;
    }
    [data-theme="light"] .dc-logo-slot{
      background: rgba(0,0,0,0.05);
      border:1px solid rgba(0,0,0,0.12);
    }
    .dc-logo-slot img{
      width: 100%;
      height: 100%;
      object-fit: contain;
      padding: 6px;
      filter: drop-shadow(0 0 10px rgba(0,200,255,0.22));
      opacity: 1;
    }

    .dc-text{ min-width: 0; text-align:left; }
    .dc-title{
      display:flex; align-items:center; gap:.55rem;
      font-weight: 800;
      line-height:1.15;
      font-size: 0.98rem;
      margin:0;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
      justify-content:flex-start;
    }
    .dc-dot{
      width:8px; height:8px; border-radius:999px;
      background: rgba(0,200,255,0.95);
      box-shadow: 0 0 18px rgba(0,200,255,0.5);
      flex:0 0 auto;
    }
    .dc-sub{
      margin:.18rem 0 0;
      font-size: .82rem;
      color: var(--muted);
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
      text-align:left;
    }

    .dc-btn{
      position:relative;
      z-index:1;
      flex: 0 0 auto;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      padding: .75rem 1.1rem;
      border-radius: 14px;
      font-weight: 900;
      letter-spacing:.2px;
      background: rgba(0,200,255,0.95);
      color: #061018;
      border: 1px solid rgba(0,200,255,0.25);
      box-shadow: 0 16px 55px rgba(0,200,255,0.16);
      transition: transform .22s var(--ease), box-shadow .22s var(--ease);
      user-select:none;
    }
    .dc-btn:hover{
      transform: translateY(-3px);
      box-shadow: 0 22px 80px rgba(0,200,255,0.20);
    }

    .cta-copy{
      max-width: 46ch;
      margin: 0;
      color: var(--muted);
      font-weight: 300;
      line-height: 1.45;
    }
    .cta-copy strong{
      color: var(--text);
      font-weight: 900;
      letter-spacing: .2px;
    }

    /* ===== Form ===== */
    .btn{
      display:inline-flex; align-items:center; justify-content:center;
      gap:.6rem;
      padding:1rem 1.4rem;
      border-radius: 18px;
      font-weight: 900;
      position:relative; overflow:hidden;
      transition: transform .22s var(--ease), box-shadow .22s var(--ease);
      border:none;
      letter-spacing:.6px;
      user-select:none;
      -webkit-tap-highlight-color: transparent;
    }
    .btn:active{ transform: translateY(-1px) scale(0.99); }
    .btn-primary{
      background: #00c8ff;
      color: #05070c;
      box-shadow: 0 18px 60px rgba(0,200,255,0.18);
    }
    .btn-primary:hover{
      transform: translateY(-6px);
      box-shadow: 0 26px 95px rgba(0,200,255,0.22);
    }
    .btn-big{
      width: 100%;
      font-size: clamp(1.05rem, 2.0vw, 1.35rem);
      letter-spacing: 1px;
      padding: 1.1rem 1.2rem;
      text-transform: uppercase;
      border-radius: 20px;
    }

    .join-shell{
      margin:0 auto;
      max-width: 920px;
      border-radius: 26px;
      background: linear-gradient(180deg, rgba(255,255,255,0.05), rgba(255,255,255,0.02));
      border: 1px solid var(--border);
      padding: 1.4rem;
      backdrop-filter: blur(14px);
      box-shadow: 0 20px 90px rgba(0,0,0,0.30);
      position:relative;
      overflow:hidden;
    }
    [data-theme="light"] .join-shell{
      background: linear-gradient(180deg, rgba(0,0,0,0.04), rgba(0,0,0,0.02));
      box-shadow: 0 16px 60px rgba(0,0,0,0.10);
    }
    .join-shell::before{
      content:"";
      position:absolute; inset:-2px;
      background: radial-gradient(700px 250px at 20% 0%, rgba(0,200,255,0.18), transparent 60%);
      opacity:.35;
      pointer-events:none;
    }

    .join-divider{
      height:1px;
      background: linear-gradient(90deg, transparent, rgba(0,200,255,0.22), transparent);
      margin: 0.5rem 0 1.0rem;
      opacity:.9;
      position:relative;
      z-index:1;
    }
    .join-action{ display:flex; justify-content:center; position:relative; z-index:1; }
    .join-action .btn{ width:min(520px, 92vw); }

    .apply-wrap{
      overflow:hidden;
      max-height: 0;
      opacity: 0;
      transform: translateY(10px);
      transition:
        max-height .55s var(--ease),
        opacity .35s var(--ease),
        transform .35s var(--ease);
      position:relative;
      z-index:1;
    }
    .apply-wrap.open{
      max-height: 1200px;
      opacity: 1;
      transform: translateY(0);
      margin-top: 1.1rem;
    }

    form.apply{
      display:flex;
      flex-direction:column;
      gap: 1rem;
      margin:0 auto;
      max-width: 680px;
      width:100%;
      padding: 1rem 0 .3rem;
    }

    .field{ display:flex; flex-direction:column; gap:.45rem; }
    form.apply label{
      font-weight: 700;
      font-size: .88rem;
      color: var(--muted);
      letter-spacing:.2px;
    }

    form.apply input, form.apply textarea{
      width:100%;
      padding: .95rem 1rem;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,0.10);
      background: rgba(255,255,255,0.03);
      color: var(--text);
      outline: none;
    }
    [data-theme="light"] form.apply input,
    [data-theme="light"] form.apply textarea{
      border: 1px solid rgba(0,0,0,0.14);
      background: rgba(0,0,0,0.03);
      color: var(--text);
    }
    form.apply input:focus, form.apply textarea:focus{
      border-color: rgba(0,200,255,0.9);
      box-shadow: 0 0 0 4px rgba(0,200,255,0.14);
      transform: translateY(-1px);
      background: rgba(255,255,255,0.05);
    }
    form.apply textarea{ resize:none }

    .char-row{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:.75rem;
      margin-top:.15rem;
      font-size:.82rem;
      color: var(--muted);
    }
    .char-pill{
      padding:.25rem .55rem;
      border-radius:999px;
      border:1px solid rgba(0,200,255,0.18);
      background: rgba(0,200,255,0.06);
      color: var(--muted);
      font-weight:700;
      letter-spacing:.2px;
      white-space:nowrap;
    }
    .char-pill.ok{
      border-color: rgba(0,200,255,0.38);
      background: rgba(0,200,255,0.10);
      color: var(--text);
    }

    .btn[disabled]{ opacity:.55; cursor:not-allowed !important; }

    footer{ padding:2.2rem 0; margin-top: 2.2rem; }
    footer .container{ text-align:center; }
    footer p{ margin:0; color:var(--muted); font-size:.92rem }

    /* =========================================================
       INTRO LOGO
       ========================================================= */
    #introLogo{
      position: fixed;
      inset: 0;
      z-index: 3100;
      display: grid;
      place-items: center;
      background: rgba(0,0,0,0.88);
      backdrop-filter: blur(10px);
      opacity: 0;
      pointer-events: none;
      transition: opacity .25s var(--ease);
    }
    #introLogo.show{ opacity: 1; pointer-events: auto; }

    #introLogo .intro-img{
      width: min(360px, 72vw);
      height: auto;
      filter: drop-shadow(0 0 22px rgba(0,200,255,0.35));
      opacity: 0;
      animation: introBlinkOnce 1.9s ease-in-out 1 forwards;
      will-change: opacity, transform;
      transform: translateZ(0);
    }
    @keyframes introBlinkOnce{
      0%   { opacity: 0;   transform: scale(0.985); }
      28%  { opacity: 1;   transform: scale(1.01); }
      70%  { opacity: 1;   transform: scale(1.01); }
      100% { opacity: 0;   transform: scale(0.99); }
    }

    .fly-clone{
      position: fixed;
      left: 50%;
      top: 50%;
      transform: translate(-50%,-50%);
      width: min(360px, 72vw);
      height: auto;
      z-index: 3200;
      pointer-events: none;
      filter: drop-shadow(0 0 18px rgba(0,200,255,0.30));
      will-change: transform, opacity;
    }
    .fly-clone.fly{
      transition: transform 760ms var(--ease), opacity 420ms var(--ease), filter 760ms var(--ease);
    }

    /* =========================================================
       TOAST
       ========================================================= */
    .toast{
      position: fixed;
      left: 50%;
      bottom: 22px;
      transform: translateX(-50%) translateY(10px);
      z-index: 4000;
      min-width: min(520px, 92vw);
      border-radius: 16px;
      padding: .95rem 1.05rem;
      background: linear-gradient(180deg, rgba(255,255,255,0.07), rgba(255,255,255,0.03));
      border: 1px solid rgba(255,255,255,0.12);
      backdrop-filter: blur(14px);
      box-shadow: 0 18px 70px rgba(0,0,0,0.28);
      opacity: 0;
      pointer-events: none;
      transition: opacity .25s var(--ease), transform .25s var(--ease);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:.9rem;
    }
    [data-theme="light"] .toast{
      background: linear-gradient(180deg, rgba(0,0,0,0.05), rgba(0,0,0,0.02));
      border: 1px solid rgba(0,0,0,0.12);
      box-shadow: 0 14px 50px rgba(0,0,0,0.10);
    }
    .toast.show{ opacity: 1; pointer-events:auto; transform: translateX(-50%) translateY(0); }
    .toast .t-title{ font-weight:900; letter-spacing:.2px; }
    .toast .t-desc{ color: var(--muted); font-weight:300; font-size:.9rem; margin:.15rem 0 0; }
    .toast .t-x{
      border:none;
      border-radius: 12px;
      padding:.55rem .7rem;
      background: rgba(0,0,0,0.25);
      color: var(--text);
      border: 1px solid rgba(255,255,255,0.12);
      cursor:pointer;
    }
    [data-theme="light"] .toast .t-x{
      background: rgba(0,0,0,0.06);
      color: var(--text);
      border: 1px solid rgba(0,0,0,0.12);
    }

    @media (max-width:720px){
      .discord-card{ width: 92%; }
      .corner-logo{ opacity: 0.08; filter: blur(2px); }
      .scroll-fab{ right: 14px; bottom: 14px; }
    }
  </style>
</head>

<body>

  <div class="bg-logo" aria-hidden="true"></div>

  <!-- ‚úÖ 1 luz passeando -->
  <div class="bg-beam" aria-hidden="true"></div>

  <div class="grain-layer" aria-hidden="true"></div>

  <!-- ‚úÖ rastro do mouse -->
  <canvas id="sparkleCanvas" aria-hidden="true"></canvas>

  <!-- Splash -->
  <div id="introLogo" aria-hidden="false">
    <!-- ‚úÖ vai trocar para preto no tema light -->
    <img class="intro-img" id="introLogoImg" src="LogoInicio.png" alt="Logo de in√≠cio">
  </div>

  <div id="preloader" aria-hidden="false"><div class="spinner" aria-hidden="true"></div></div>

  <div class="floating-controls" aria-hidden="false">
    <button id="themeToggle" class="icon-btn" title="Alternar tema" aria-pressed="false" aria-label="Alternar tema">
      <span id="themeIcon">üåô</span>
    </button>
  </div>

  <!-- ‚úÖ Setinha (canto inferior direito) -->
  <button id="scrollFab" class="scroll-fab" type="button" title="Descer" aria-label="Descer">
    <span id="scrollFabIcon">‚Üì</span>
  </button>

  <div class="top-space">
    <div class="logo-wrap" aria-label="Logo da empresa">
      <div class="logo-placeholder">
        <img id="logoImg" src="logo-white.png" alt="Zona Sul Ag√™ncia Criativa">
      </div>
    </div>
  </div>

  <section id="sobre" class="content">
    <div class="container">
      <div class="profile">
        <div class="profile-left">
          <img class="avatar" src="rayanne.jpg" alt="Rayanne Vit√≥ria" />

          <div class="mini-icons" aria-label="Links r√°pidos">
            <a class="soc" data-ic="instagram" href="https://www.instagram.com/raaydesigner_/" target="_blank" rel="noopener" aria-label="Instagram" title="Instagram">
              <img class="icon-theme" data-base="FFFFFF" src="https://img.icons8.com/?size=100&id=85140&format=png&color=FFFFFF" alt="Instagram">
            </a>
            <a class="soc" data-ic="tiktok" href="https://www.tiktok.com/@raaydesigner_" target="_blank" rel="noopener" aria-label="TikTok" title="TikTok">
              <img class="icon-theme" data-base="FFFFFF" src="https://img.icons8.com/?size=100&id=118638&format=png&color=FFFFFF" alt="TikTok">
            </a>
            <a class="soc" data-ic="email" href="mailto:zonasulagenciacriativa@outlook.com.br" aria-label="Email" title="Email">
              <img class="icon-theme" data-base="FFFFFF" src="https://img.icons8.com/?size=100&id=iUAL2gKFxVxc&format=png&color=FFFFFF" alt="Email">
            </a>
            <a class="soc" data-ic="link portf√≥lio" href="https://www.behance.net/zonasulstore" target="_blank" rel="noopener" aria-label="Behance" title="Behance">
              <img class="icon-theme" data-base="FFFFFF" src="https://img.icons8.com/?size=100&id=16280&format=png&color=FFFFFF" alt="Behance">
            </a>
          </div>
        </div>

        <div class="profile-right">
          <h3 class="name">Rayanne Vit√≥ria</h3>

          <p class="bio">
            Fundadora da <span class="brand">Zona Sul Ag√™ncia Criativa</span>. Designer gr√°fica desde 2019, atua no desenvolvimento de identidades visuais e solu√ß√µes criativas para o mercado gamer, liderando uma equipe especializada em projetos para diferentes jogos.
          </p>

          <div class="cta">
            <div class="discord-card" role="group" aria-label="Entrar no Discord">
              <div class="dc-left">
                <div class="dc-logo-slot" aria-hidden="false">
                  <!-- ‚úÖ vai trocar para preto no tema light -->
                  <img id="dcLogoImg" src="LogoInicio.png" alt="Logo Zona Sul">
                </div>

                <div class="dc-text">
                  <p class="dc-title"><span class="dc-dot"></span>Zona Sul Ag√™ncia Criativa</p>
                  <p class="dc-sub">
                    <span id="memberCount">‚Äî</span> Membros
                  </p>
                </div>
              </div>

              <a class="dc-btn" id="discordBtn" href="https://discord.com/invite/zonasul" target="_blank" rel="noopener">
                Juntar-se
              </a>
            </div>

            <p class="cta-copy">
              <strong>Voc√™ tem talento</strong><br>
              e quer fazer parte de uma equipe criativa de verdade?
            </p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section id="junte-se" class="content">
    <div class="container">
      <div class="join-shell">
        <div class="join-action">
          <button class="btn btn-primary btn-big" id="openApplyBtn" type="button">Juntar-se √† equipe</button>
        </div>

        <div class="join-divider" aria-hidden="true"></div>

        <div id="applyWrap" class="apply-wrap" aria-hidden="true">
          <form id="applyForm" class="apply" novalidate>
            <div class="field">
              <label for="discordUser">User do Discord *</label>
              <input id="discordUser" name="discordUser" type="text" placeholder="Ex.: FAIXA" required>
            </div>

            <div class="field">
              <label for="fullname">Nome Completo *</label>
              <input id="fullname" name="fullname" type="text" placeholder="Rayanne Vit√≥ria" required>
            </div>

            <div class="field">
              <label for="age">Idade *</label>
              <input id="age" name="age" type="number" placeholder="25" min="13" required>
            </div>

            <div class="field">
              <label for="region">Regi√£o *</label>
              <input id="region" name="region" type="text" placeholder="Rio de janeiro" required>
            </div>

            <div class="field">
              <label for="experience">Tempo de Experi√™ncia (em anos) *</label>
              <input id="experience" name="experience" type="number" placeholder="3" min="0" required>
            </div>

            <div class="field">
              <label for="portfolio">Link do portf√≥lio *</label>
              <input id="portfolio" name="portfolio" type="url" placeholder="https://www.behance.net/zonasulstore" required>
            </div>

            <div class="field">
              <label for="cnpj">CNPJ (Ativo) *</label>
              <input id="cnpj" name="cnpj" type="text" placeholder="58.673.835/0001-92" required>
            </div>

            <div class="field">
              <label for="skills">Conte-nos sobre voc√™ *</label>
              <textarea id="skills" name="skills" rows="4" placeholder="sua experi√™ncia e especialidades..." required></textarea>
              <div class="char-row" aria-live="polite">
                <span>m√≠nimo: <strong>200</strong> caracteres</span>
                <span id="charPill" class="char-pill">0/200</span>
              </div>
            </div>

            <div class="info-note" role="note" aria-live="polite">
              <span class="info-ic" aria-hidden="true">i</span>
              <span class="info-text">As informa√ß√µes fornecidas devem ser verdadeiras e precisas.</span>
            </div>

            <button type="submit" class="btn btn-primary" id="submitBtn" disabled>Enviar Inscri√ß√£o</button>
          </form>
        </div>
      </div>
    </div>
  </section>

  <footer>
    <div class="container">
      <p>&copy; <span id="year"></span> Zona Sul Ag√™ncia Criativa</p>
    </div>
  </footer>

  <!-- Toast -->
  <div id="toast" class="toast" role="status" aria-live="polite" aria-atomic="true">
    <div>
      <div id="toastTitle" class="t-title">Enviado!</div>
      <div id="toastDesc" class="t-desc">Sua inscri√ß√£o foi enviada com sucesso.</div>
    </div>
    <button id="toastClose" class="t-x" type="button">Fechar</button>
  </div>

  <script>
    const WEBHOOK_URL = "https://discord.com/api/webhooks/1476679954476437706/cPJ3W2v9r4fczuYF_PqMM3uM85ZS41Fzi5TTZHBUbzgDk1-CYW1Pm-E6q5D229PaAhvG";
    const MIN_CHARS = 200;

    document.getElementById('year').textContent = new Date().getFullYear();

    /* =========================
       PRELOADER (nunca infinito)
       ========================= */
    (function(){
      const pre = document.getElementById('preloader');
      if (!pre) return;
      function hide(){
        pre.classList.add('loaded');
        pre.setAttribute('aria-hidden','true');
      }
      window.addEventListener('load', hide);
      setTimeout(hide, 1800);
    })();

    /* =========================
       ‚úÖ SETINHA (descer/subir)
       ========================= */
    (function scrollFab(){
      const btn = document.getElementById('scrollFab');
      const ic  = document.getElementById('scrollFabIcon');
      if (!btn || !ic) return;

      function update(){
        const y = window.scrollY || document.documentElement.scrollTop || 0;
        const nearTop = y < 140;

        if (nearTop){
          btn.dataset.dir = 'down';
          ic.textContent = '‚Üì';
          btn.title = 'Descer';
          btn.setAttribute('aria-label', 'Descer');
        } else {
          btn.dataset.dir = 'up';
          ic.textContent = '‚Üë';
          btn.title = 'Subir';
          btn.setAttribute('aria-label', 'Subir');
        }
      }

      btn.addEventListener('click', () => {
        const dir = btn.dataset.dir || 'down';
        if (dir === 'down'){
          const max = document.documentElement.scrollHeight;
          window.scrollTo({ top: max, behavior: 'smooth' });
        } else {
          window.scrollTo({ top: 0, behavior: 'smooth' });
        }
      });

      window.addEventListener('scroll', update, { passive:true });
      window.addEventListener('resize', update, { passive:true });
      update();
    })();

    /* =========================
       THEME TOGGLE
       ========================= */
    function applyCursorTheme(force){
      const isLight = document.documentElement.getAttribute('data-theme') === 'light';
      const file = isLight ? 'cursor-white.png' : 'cursor-white.png';
      const v = force ? Date.now() : '1';
      const def = `url("${file}?v=${v}") 12 2, auto`;
      const ptr = `url("${file}?v=${v}") 12 2, pointer`;

      document.documentElement.style.setProperty('--cursor-default', def);
      document.documentElement.style.setProperty('--cursor-pointer', ptr);

      let style = document.getElementById('cursor-style');
      if (!style){
        style = document.createElement('style');
        style.id = 'cursor-style';
        document.head.appendChild(style);
      }
      style.textContent = `
        html, body, * { cursor: ${def} !important; }
        a, button, .icon-btn, .btn, .mini-icons a, [role="button"] { cursor: ${ptr} !important; }
        input, textarea, select { cursor: text !important; }
      `;
    }

    function setTheme(isLight){
      if (isLight) document.documentElement.setAttribute('data-theme','light');
      else document.documentElement.removeAttribute('data-theme');
      localStorage.setItem('theme', isLight ? 'light' : 'dark');

      // ‚úÖ logo principal j√° alterna
      const logo = document.getElementById('logoImg');
      if (logo) logo.src = isLight ? 'logo.png' : 'logo-white.png';

      // ‚úÖ logo do print (LogoInicio) -> preto no modo white
      // (Crie esse arquivo: "LogoInicio-black.png")
      const introLogo = document.getElementById('introLogoImg');
      if (introLogo) introLogo.src = isLight ? 'LogoInicio-black.png' : 'LogoInicio.png';

      const dcLogo = document.getElementById('dcLogoImg');
      if (dcLogo) dcLogo.src = isLight ? 'LogoInicio-black.png' : 'LogoInicio.png';

      updateSocialIconsBase();
      applyCursorTheme(true);

      const icon = document.getElementById('themeIcon');
      const toggle = document.getElementById('themeToggle');
      if (icon) icon.textContent = isLight ? '‚òÄÔ∏è' : 'üåô';
      if (toggle) toggle.setAttribute('aria-pressed', String(isLight));
    }

    (function(){
      const toggle = document.getElementById('themeToggle');
      const saved = localStorage.getItem('theme') || 'dark';
      setTheme(saved === 'light');

      toggle?.addEventListener('click', () => {
        const isLight = document.documentElement.getAttribute('data-theme') === 'light';
        setTheme(!isLight);
      });
    })();

    /* =========================
       √çCONES
       ========================= */
    function replaceColorParam(url, colorHex){
      if (!url.includes('img.icons8.com')) return url;
      if (url.includes('color=')) return url.replace(/color=[0-9A-Fa-f]{3,6}/, `color=${colorHex}`);
      return url + `&color=${colorHex}`;
    }

    function updateSocialIconsBase(){
      const isLight = document.documentElement.getAttribute('data-theme') === 'light';
      const base = isLight ? '000000' : 'FFFFFF';
      document.querySelectorAll('.icon-theme').forEach(img=>{
        const src = img.getAttribute('src') || '';
        img.setAttribute('data-base', base);
        img.src = replaceColorParam(src, base);
      });
    }

    (function(){
      const BLUE = '00C8FF';
      document.querySelectorAll('.mini-icons a').forEach(a=>{
        const img = a.querySelector('img.icon-theme');
        if (!img) return;

        a.addEventListener('mouseenter', () => img.src = replaceColorParam(img.src, BLUE));
        a.addEventListener('mouseleave', () => {
          const base = img.getAttribute('data-base') || 'FFFFFF';
          img.src = replaceColorParam(img.src, base);
        });
      });
    })();

    /* =========================
       Membros reais (invite counts)
       ========================= */
    (function discordMemberCount(){
      const el = document.getElementById('memberCount');
      const btn = document.getElementById('discordBtn');
      if (!el || !btn) return;

      const inviteUrl = btn.getAttribute('href');
      const match = (inviteUrl || '').match(/discord\.com\/invite\/([^/?#]+)/i);
      const code = match ? match[1] : null;
      if (!code) return;

      const fmt = (n) => new Intl.NumberFormat('pt-BR').format(n);

      fetch(`https://discord.com/api/v10/invites/${encodeURIComponent(code)}?with_counts=true&with_expiration=true`, {
        method: 'GET',
        mode: 'cors',
        cache: 'no-store'
      })
      .then(r => r.ok ? r.json() : Promise.reject(r.status))
      .then(data => {
        const count = data?.approximate_member_count;
        el.textContent = (typeof count === 'number') ? fmt(count) : '‚Äî';
      })
      .catch(() => el.textContent = '‚Äî');
    })();

    /* =========================
       INTRO: encaixar no "O"
       ========================= */
    (function introDockToO(){
      const intro = document.getElementById('introLogo');
      const introImg = intro?.querySelector('.intro-img');
      const target = document.getElementById('logoImg');
      if (!intro || !introImg || !target) return;

      function rect(el){ return el.getBoundingClientRect(); }

      function start(){
        intro.classList.add('show');

        setTimeout(() => {
          const rFrom = rect(introImg);
          const rTo = rect(target);

          const toX = rTo.left + (rTo.width * 0.25);
          const toY = rTo.top  + (rTo.height * 0.52);

          const fromX = rFrom.left + rFrom.width/2;
          const fromY = rFrom.top  + rFrom.height/2;

          const dx = toX - fromX;
          const dy = toY - fromY;

          const clone = introImg.cloneNode(true);
          clone.classList.add('fly-clone');
          document.body.appendChild(clone);

          clone.style.opacity = '1';
          clone.style.transform = `translate(-50%,-50%) translate(0px, 0px) scale(1)`;

          requestAnimationFrame(() => {
            clone.classList.add('fly');
            clone.style.transform = `translate(-50%,-50%) translate(${dx}px, ${dy}px) scale(0.16)`;
            clone.style.opacity = '0.15';
            clone.style.filter = 'drop-shadow(0 0 10px rgba(0,200,255,0.18))';
          });

          setTimeout(() => {
            intro.style.opacity = '0';
            intro.style.pointerEvents = 'none';
          }, 120);

          setTimeout(() => {
            clone.remove();
            intro.remove();
          }, 820);

        }, 1900);
      }

      start();
    })();

    /* =========================
       Abrir/fechar form
       ========================= */
    (function(){
      const wrap = document.getElementById('applyWrap');
      const btn = document.getElementById('openApplyBtn');

      btn?.addEventListener('click', () => {
        if (!wrap) return;
        const isOpen = wrap.classList.contains('open');
        wrap.classList.toggle('open', !isOpen);
        wrap.setAttribute('aria-hidden', isOpen ? 'true' : 'false');
      });
    })();

    /* =========================
       Sons (click + form)
       ========================= */
    (function soundFX(){
      const clickSound = new Audio('click_cursor.mp3');
      const formSound  = new Audio('form.mp3');
      clickSound.preload='auto';
      formSound.preload='auto';
      clickSound.volume=0.85;
      formSound.volume=0.95;

      let unlocked=false;
      let suppressNextClick=false;

      function safePlay(audio){
        try{
          audio.currentTime = 0;
          const p = audio.play();
          if (p && p.catch) p.catch(()=>{});
        }catch(e){}
      }

      function unlock(){
        if (unlocked) return;
        unlocked=true;
        clickSound.volume=0.001;
        safePlay(clickSound);
        setTimeout(()=> clickSound.pause(), 30);
        setTimeout(()=> clickSound.volume=0.85, 80);
        window.removeEventListener('pointerdown', unlock, true);
        window.removeEventListener('keydown', unlock, true);
      }
      window.addEventListener('pointerdown', unlock, true);
      window.addEventListener('keydown', unlock, true);

      document.addEventListener('click', () => {
        if (suppressNextClick){ suppressNextClick=false; return; }
        safePlay(clickSound);
      }, true);

      window.__playFormSound = function(){
        suppressNextClick=true;
        safePlay(formSound);
      };
    })();

    /* =========================
       Toast popup
       ========================= */
    (function(){
      const toast = document.getElementById('toast');
      const title = document.getElementById('toastTitle');
      const desc  = document.getElementById('toastDesc');
      const close = document.getElementById('toastClose');
      let timer = null;

      function showToast(t, d){
        if (!toast) return;
        if (title) title.textContent = t;
        if (desc)  desc.textContent = d;

        toast.classList.add('show');

        // ‚úÖ toca SOMENTE quando o popup aparece
        if ((t || '').toLowerCase().includes('enviado')) {
          window.__playFormSound?.();
        }

        clearTimeout(timer);
        timer = setTimeout(() => toast.classList.remove('show'), 3200);
      }

      close?.addEventListener('click', () => toast.classList.remove('show'));
      window.__toast = showToast;
    })();

    /* =========================
       Gate 200 chars + envio
       ========================= */
    (function(){
      const form = document.getElementById('applyForm');
      const submitBtn = document.getElementById('submitBtn');
      const skills = document.getElementById('skills');
      const charPill = document.getElementById('charPill');
      if (!form || !submitBtn || !skills || !charPill) return;

      function normalizeLen(text){
        return text.replace(/\s+/g,' ').trim().length;
      }

      function updateGate(){
        const len = normalizeLen(skills.value || '');
        const ok = len >= MIN_CHARS;
        submitBtn.disabled = !ok;
        charPill.textContent = `${Math.min(len, MIN_CHARS)}/${MIN_CHARS}`;
        charPill.classList.toggle('ok', ok);
        skills.setCustomValidity(ok ? '' : `Escreva pelo menos ${MIN_CHARS} caracteres.`);
      }

      skills.addEventListener('input', updateGate);
      updateGate();

      form.addEventListener('submit', async (e) => {
        e.preventDefault();
        updateGate();

        if (submitBtn.disabled) { skills.reportValidity(); skills.focus(); return; }
        if (!form.reportValidity()) return;

        window.__playFormSound?.();

        submitBtn.disabled = true;
        const original = submitBtn.textContent;
        submitBtn.textContent = 'Enviando...';

        const data = {
          discordUser: form.discordUser.value.trim(),
          fullname: form.fullname.value.trim(),
          age: form.age.value,
          region: form.region.value.trim(),
          experience: form.experience.value,
          portfolio: form.portfolio.value.trim(),
          cnpj: form.cnpj.value.trim(),
          skills: form.skills.value.trim()
        };

        const payload = {
          content:
`**Nova inscri√ß√£o - Junte-se √† equipe**
Discord: ${data.discordUser}
Nome: ${data.fullname}
Idade: ${data.age}
Regi√£o: ${data.region}
Experi√™ncia: ${data.experience} anos
Portf√≥lio: ${data.portfolio || '-'}
CNPJ: ${data.cnpj || '-'}

Habilidades:
${data.skills}`
        };

        try {
          const resp = await fetch(WEBHOOK_URL, {
            method:'POST',
            headers:{'Content-Type':'application/json'},
            body:JSON.stringify(payload)
          });

          if (resp.ok) {
            form.reset();
            updateGate();
            submitBtn.textContent = original;
            submitBtn.disabled = true;
            window.__toast?.('Enviado!', 'Sua inscri√ß√£o foi enviada com sucesso.');
          } else {
            submitBtn.textContent = original;
            updateGate();
            window.__toast?.('Erro ao enviar', 'Tente novamente em alguns instantes.');
          }
        } catch (err) {
          submitBtn.textContent = original;
          updateGate();
          window.__toast?.('Falha de conex√£o', 'Verifique sua internet e tente novamente.');
        }
      });
    })();

(function cursorBlueStreak_Smooth(){
  const canvas = document.getElementById('sparkleCanvas');
  if (!canvas) return;

  const prefersReduce = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;
  if (prefersReduce) return;

  const ctx = canvas.getContext('2d', { alpha:true, desynchronized:true });

  let dpr = Math.min(window.devicePixelRatio || 1, 2);
  function resize(){
    dpr = Math.min(window.devicePixelRatio || 1, 2);
    canvas.width  = Math.floor(innerWidth * dpr);
    canvas.height = Math.floor(innerHeight * dpr);
    canvas.style.width  = innerWidth + 'px';
    canvas.style.height = innerHeight + 'px';
    ctx.setTransform(dpr,0,0,dpr,0,0);
    ctx.clearRect(0,0,innerWidth,innerHeight);
  }
  resize();
  addEventListener('resize', resize, { passive:true });

  const C = { r:0, g:200, b:255 };
  const rgba = (r,g,b,a)=>`rgba(${r},${g},${b},${a})`;
  const clamp = (v,a,b)=>Math.max(a,Math.min(b,v));

  // ===== par√¢metros ‚Äúsuaves‚Äù =====
  const pts = [];
  const MAX_AGE = 90;          // dura um pouco mais p/ ficar sedoso
  const TARGET_LEN = 160;      // comprimento parecido com o print
  const MIN_MOVE = 0.35;       // pega mais pontos -> mais suave
  const SPLINE_STEPS = 10;     // densidade da curva (mais = mais suave)

  let pmx = innerWidth*0.5, pmy = innerHeight*0.5;
  let lastMove = performance.now();
  let running = true;

  document.addEventListener('visibilitychange', () => running = !document.hidden);

  addEventListener('pointermove', (e)=>{
    const mx = e.clientX, my = e.clientY;
    const dx = mx - pmx, dy = my - pmy;

    if (Math.hypot(dx,dy) >= MIN_MOVE){
      pts.push({x:mx, y:my, t:performance.now()});
      pmx = mx; pmy = my;
      lastMove = performance.now();
    }
  }, { passive:true });

  // ===== apagar SEM manchar =====
  function fade(){
    const idle = (performance.now() - lastMove) > 80;
    ctx.save();
    ctx.globalCompositeOperation = 'destination-out';
    ctx.fillStyle = 'rgba(0,0,0,1)';
    ctx.globalAlpha = idle ? 0.52 : 0.34; // maior = apaga mais r√°pido
    ctx.fillRect(0,0,innerWidth,innerHeight);
    ctx.restore();
  }

  function getTailIndex(){
    if (pts.length < 2) return 0;
    let acc = 0;
    for (let i = pts.length-1; i>0; i--){
      const a = pts[i], b = pts[i-1];
      acc += Math.hypot(a.x-b.x, a.y-b.y);
      if (acc >= TARGET_LEN) return i-1;
    }
    return 0;
  }

  // Catmull-Rom spline (suaviza demais)
  function catmullRom(p0,p1,p2,p3,t){
    const t2 = t*t, t3 = t2*t;
    return {
      x: 0.5 * ((2*p1.x) + (-p0.x+p2.x)*t + (2*p0.x-5*p1.x+4*p2.x-p3.x)*t2 + (-p0.x+3*p1.x-3*p2.x+p3.x)*t3),
      y: 0.5 * ((2*p1.y) + (-p0.y+p2.y)*t + (2*p0.y-5*p1.y+4*p2.y-p3.y)*t2 + (-p0.y+3*p1.y-3*p2.y+p3.y)*t3)
    };
  }

  function buildSmoothPath(segment){
    const out = [];
    if (segment.length < 2) return out;

    const list = [segment[0], ...segment, segment[segment.length-1]];

    for (let i=0; i<list.length-3; i++){
      const p0 = list[i], p1 = list[i+1], p2 = list[i+2], p3 = list[i+3];
      for (let s=0; s<SPLINE_STEPS; s++){
        const t = s / SPLINE_STEPS;
        out.push(catmullRom(p0,p1,p2,p3,t));
      }
    }
    out.push(segment[segment.length-1]);
    return out;
  }

  function strokePath(path, lw, color, alpha, shadowBlur){
    if (path.length < 2) return;

    ctx.save();
    ctx.globalCompositeOperation = 'lighter';
    ctx.strokeStyle = color;
    ctx.globalAlpha = alpha;
    ctx.lineWidth = lw;
    ctx.lineCap = 'round';
    ctx.lineJoin = 'round';

    ctx.shadowColor = color;
    ctx.shadowBlur = shadowBlur;

    ctx.beginPath();
    ctx.moveTo(path[0].x, path[0].y);
    for (let i=1;i<path.length;i++) ctx.lineTo(path[i].x, path[i].y);
    ctx.stroke();
    ctx.restore();
  }

  function draw(){
    const now = performance.now();

    while (pts.length && (now - pts[0].t) > MAX_AGE) pts.shift();
    if (pts.length < 2) return;

    const tailIdx = getTailIndex();
    const seg = pts.slice(tailIdx);
    if (seg.length < 2) return;

    const head = seg[seg.length-1];
    const tail = seg[0];
    const dist = Math.hypot(head.x-tail.x, head.y-tail.y);
    if (dist < 8) return;

    const life = clamp(dist / TARGET_LEN, 0.35, 1.0);

    const path = buildSmoothPath(seg);

    strokePath(path, 7.0, rgba(C.r,C.g,C.b,1), 0.05*life, 18);
    strokePath(path, 3.6, rgba(C.r,C.g,C.b,1), 0.11*life, 12);
    strokePath(path, 1.3, 'rgba(255,255,255,1)', 0.18*life, 2);

    ctx.save();
    ctx.globalCompositeOperation = 'lighter';
    const g = ctx.createRadialGradient(head.x, head.y, 0, head.x, head.y, 26);
    g.addColorStop(0.0, rgba(255,255,255,0.14*life));
    g.addColorStop(0.35, rgba(C.r,C.g,C.b,0.18*life));
    g.addColorStop(1.0, rgba(C.r,C.g,C.b,0.0));
    ctx.fillStyle = g;
    ctx.beginPath();
    ctx.arc(head.x, head.y, 26, 0, Math.PI*2);
    ctx.fill();
    ctx.restore();
  }

  function tick(){
    if (!running){ requestAnimationFrame(tick); return; }
    fade();
    draw();
    requestAnimationFrame(tick);
  }

  ctx.clearRect(0,0,innerWidth,innerHeight);
  requestAnimationFrame(tick);
})();
  </script>
</body>
</html>